# One-Pager: Cosmic Context – Educational Module for Hindu Panchanga

## Vision
Transform the Panchanga calculator into a **storytelling portal** that shows users how their birth moment aligns with real astronomical events. By visualizing the sky and providing concise, science‑backed fact cards, we bridge the gap between Indian Vedic astronomy and modern astrophysics, sparking curiosity among newcomers.

---

## Core Features (Phase 1)

### 1️⃣ Fact‑Card Engine (Educational Overlay)
- **What**: Dynamic cards displayed alongside the Panchanga results.
- **Content examples**:
  - *Purnima*: "At your birth the Sun and Moon were exactly opposite (180°) – a full Moon.
  - *Nakshatra*: "Your Moon was in **Magha**, i.e., near the bright star **Regulus** in the Leo constellation.
  - *Sidereal vs. Tropical*: Explain why Vedic signs differ from Western zodiac.
- **Implementation**:
  - Extend `utils/astronomy.py` to expose raw angular data (ecliptic longitude, phase, declination).
  - Add a small templating helper in Flask (`render_template`) that selects appropriate card text based on the computed values.
  - Front‑end: simple `<div class="fact-card">` with CSS animation for entry.

### 2️⃣ Sky‑Shot (Simplified 2‑D Sky Map)
- **Goal**: Render a static PNG/SVG showing the night sky at the exact birth time & location.
- **Elements**:
  - Ecliptic path, constellations, and the 27 Nakshatra boundaries.
  - Highlight the Moon's position and phase.
  - Optional: Sun position (if daytime birth).
- **Tech stack**:
  - Backend: Use **Skyfield** to compute RA/Dec for stars and the Moon; convert to Alt/Az for the user's location.
  - Rendering: **Matplotlib** (polar plot) → PNG saved to `/static/skyshots/`.
  - Front‑end: `<img src="/static/skyshots/{{uid}}.png" alt="Your sky at birth">`.
- **Performance**: Cache images by a hash of `(date,time,lat,lon)` using a simple file‑system cache (e.g., `cache/skyshots/`).

### 3️⃣ Solar‑System Mini‑View (Optional for Phase 2)
- Top‑down view of planetary positions at birth.
- Use the same coordinate data from Skyfield; render with **Plotly** or **D3.js**.

---

## Architecture Overview

```
+-------------------+      +-------------------+      +-------------------+
|   Front‑End (UI) |<---->|   Flask API (V1)  |<---->|   Skyfield Core   |
|  - HTML/CSS/JS   |      |  - /api/panchanga |      |  - Ephemeris data |
|  - Fact‑Cards     |      |  - /api/skyshot   |      |  - XYZ/RA/Dec     |
|  - Sky‑Shot Img  |      |  - /api/cache     |      +-------------------+
+-------------------+      +-------------------+                |
        ^                         ^                         |
        |                         |                         |
        |                         |                         |
        |                         |                         |
        |                         |                         |
        |                         |                         v
        |                         |                +-------------------+
        |                         +----------------|   Redis / FS Cache |
        |                                          +-------------------+
        +----------------------------------------------> Persistent Storage
```

- **Flask API**: New endpoints `GET /api/skyshot` (returns image URL) and `GET /api/fact‑cards` (JSON with card texts).
- **Cache Layer**: A lightweight Redis instance (or simple file‑system cache) to avoid recomputing identical sky maps.
- **Static Assets**: Generated PNGs stored under `static/skyshots/` and served directly by Nginx.
- **Deployment**: No changes to existing Docker/NGINX setup; just mount the new `static/skyshots/` directory.

---

## Phase‑Wise Plan of Action

| Phase | Milestones | Owner | ETA |
|------|------------|-------|-----|
| **0 – Prep** | - Ensure `skyfield` ephemeris files are up‑to‑date.<br>- Add caching utilities. | Backend | 1 wk |
| **1 – Fact‑Cards** | - Extend `utils/astronomy.py` to expose raw angles.<br>- Implement `/api/fact‑cards`.<br>- Add UI component and CSS. | Full‑stack | 2 wks |
| **2 – Sky‑Shot** | - Compute Alt/Az for Moon & stars.<br>- Render PNG with Matplotlib.<br>- Store & serve via Nginx.<br>- Add UI gallery. | Backend + UI | 3 wks |
| **3 – Cache & Performance** | - Add Redis (or file‑cache) for sky‑shots.<br>- Benchmark latency. | DevOps | 1 wk |
| **4 – Documentation & Release** | - Update README, add user guide section.<br>- Publish new version tag `v4.0‑cosmic‑context`. | Docs | 1 wk |

**Total effort**: ~8 weeks (≈2 months) for a production‑ready educational module.

---

## Success Metrics
- **Engagement**: Increase average session time by ≥ 30 %.
- **Education**: ≥ 70 % of users report "I learned something new" (via optional feedback modal).
- **Performance**: Sky‑Shot generation < 2 seconds for cached images.

---

## Next Steps
1. **Approve** this roadmap.
2. **Allocate** a small Redis instance (or confirm file‑system cache is acceptable).
3. **Kick‑off** Phase 0 by updating the `requirements.txt` with `matplotlib` and (optional) `redis`.

---

*All advanced Vedic‑astrology features (Navagraha, Dasha, etc.) are preserved for future development.*
